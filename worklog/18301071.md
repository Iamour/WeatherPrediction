# 日志
by 18301071 
## 日志内容
## 6.30
## 上午

1. 已完成python环境安装配置
2. 已完成pyCharm安装配置
3. 已完成java环境配置
4. Spark环境配置 进行中 Hadoop好像还有问题，电脑内存不够了 

## 下午

1. 小组进行了任务调整，我负责java调用接口工作（任务点19-20）
2. 进行myEclipse的安装，由于试图下载破解版导致下载了一堆奇奇怪怪的应用，清理浪费了很多时间。最后到官网进行下载，只有30天的试用期。
3. Tomcat的下载与配置正在进行中。

## 7.1
## 上午
1. 进行了Tomcat的安装与配置，startup成功，但发现无法打开网址http://localhost:8080 ，经试验发现必须先启动Tomcat服务器，且不能关闭才能成功打开该页面。
2. 下好Tomcat后对myeclipse进行配置，昨天me打开是成功的，今天突然提示没有JRE或者JDK导致无法启动。在me中的设置中手动添加jdk路径后，成功启动me。启动很慢，不知道是不是电脑的问题。

总的来说，初步完成了环境的安装与配置

## 下午
1. 小组进行分工细化，大家分别汇报了当前的工作进展以及遇到的问题，讨论解决方法。
1. 和王迪讨论了一下我们任务之间的关系，如何配合。
1. 在网上查阅一些资料，对于java调用python的方法有一个初步的了解，但对于利用java传递什么参数方面仍然不太清晰。

## 7.2
## 上午
1. 与小组成员讨论任务间关系，继续查阅相关资料。有地方不是很明白，该项目是需要两个服务器tomcat以及flask吗。两个任务之间是否重合。

## 下午
1. 小组讨论了任务间的关系问题，服务器的选择问题，决定只用tomcat服务器
1. 查阅java http请求相关资料，考虑使用什么框架。

## 7.3
## 上午
1. myeclipse打不开，无法解决。重新在eclipse里配置tomcat。
1. 再次讨论了tomcat和flask，进一步查阅资料，终于理解两个的关系(应该吧)，flask是框架自带服务器，tomcat是服务器容器。

## 下午
1. 重新在eclipse上配置tomcat
1. web项目无法成功运行，总是出现404的情况，查阅大量资料以及多次尝试后发现，下载的eclipse不支持javaEE，采取安装插件的方法，而且，.jsp文件应该放在content的目录下，才能运行成功，但目前来看，右键项目时有时还是404，如果右键jsp文件一般能成功运行，有待解决。
1. 与组员沟通，决定使用springboot框架。
1. 查阅资料学习前后端交互、springboot。

## 7.4
1. 在eclipse中配置maven。
1. 安装spring boot插件。
1. 和组员再次沟通，明确了传递参数为两个日期，得到两个日期之间的预测数值，以json的格式返回给前端。
1. 学习java调用python的方法，刚开始采用jython出现错误，无法解决。改用命令行调用python。完成服务器与后端连接部分的编写。
1. 发现java后端python程序无法成功输出预测的数据，经排查以及与负责后端的同学沟通，发现用java运行命令行的时候，当前目录不在py文件所在的那个目录。将py文件中的py_path改为绝对路径即可。
1. 和王迪进行讨论，合并、调试代码，将我们的项目合成一个。
1. 和前端的同学进行讨论，确定传输参数、请求、返回数据的形式，以确保后面两部分能对接上。

## 7.5
尝试后端与前端的登陆界面进行连接
### 所遇问题
1. 网页报错，blank page。
1. 前端无法渲染，只在空白页左上角简单显示返回的字符串。
1. 前端点击登陆无法反应，出现403 500等多种错误
### 解决方法
1. 端口被占用，在application.propreties中更改spring 内置tomcat的端口设置（默认为8080）。
1. 前端包放错位置，应该把整个包放在static里
1. 花费大量时间排查，后端返回正常，前端请求发送正常，但是服务器并没有成功接收消息，经输出发现是null，尝试网上各种方法，发现后端响应请求函数中，参数的地方要用java bean类，而且前面一定要记得加@requestbody
1. 初步尝试与显示主页面对接，经商讨，我们打算将从python中获取的一条条预测数据(string类型)转换为自定义类，将所有数据放进列表中，转化为json串，返回给前端，该方法有待与前端对接并验证。

## 7.6
## 下午
查阅资料学习websocket将服务器与前端的连接方式更改为webscoket
### 所遇问题
1. @Autowired 报错，空指针异常
1. 定义User类时定义为Bean类，但提示没有使用bean类

### 解决方法
1. 查阅资料了解，项目启动时初始化，会初始化 websocket （非用户连接的），spring 同时会为其注入 service，该对象的 service 不是 null，被成功注入。但是，由于 spring 默认管理的是单例，所以只会注入一次 service。当新用户进入聊天时，系统又会创建一个新的 websocket 对象，这时矛盾出现了：spring 管理的都是单例，不会给第二个 websocket 对象注入 service，所以导致只要是用户连接创建的 websocket 对象，都不能再注入了。将要注入的 service 改成 static，就不会为null了。
1. 在User前加注解@Component

## 7.7
1. 安装mysql
1. 学习mysql相关资料，拟打算采用远程连接的方式将mysql与服务器相连接，将数据库部署到云端。

## 7.8
## 上午
重新与修改后的后端进行对接
### 所遇问题与解决方案
1. 调用python文件出错，原来传递参数格式改为-start XXX
1. 命令行单独调用python没有问题，但是在java中调用python没有输出，经排查依旧是路径问题

## 下午
与前端主页进行连接
1. 连接不成功，是浏览器导致的，更换为chrome浏览器即可
1. 了解学习shiro

## 7.9
## 上午
1. 小组会议对支线任务进行讨论分工
1. 尝试在在服务器部分增加shiro

## 下午
1. 进行shiro的相关学习

## 7.10
## 上午
1.进行shiro的相关学习

## 下午
1. 服务器尝试使用shiro进行拦截与身份认证
1. shiro map返回null，解决中

## 晚上
### 所遇问题与解决方案
1. shiro null 因为@Autowired注入失败，启动类前增加启动类前要加@MapperScan(value = {"com.example.demo.mapper"}) 
1. 遇到Configure包方法创建失败问题，启动类前加@ComponentScan({"com.example.demo.shiro.config.ShiroConfigur"}) 
1. 报错 内置数据库路径问题，在application.properties中的数据库设置要加spring.dataresources
1. controllor方法没有被访问，在配置文件中加spring.mvc.hiddenmethod.filter.enabled=true
1. 密码输入错误会直接终止程序，不应该采用throw的方法

## 7.11
### 所遇问题与解决方案
1. userMapper为空的问题，前面要加注解@Resource。多个mapper，每一个mapper上面都要加。
1. 管理员页面只显示用户的密码，没有姓名。发现是数据库这一属性名为name，提取的时候应该也要name才能提取成功，但是却写成了username，将数据库的名字改为username。
1. 能进入拦截方法，但发现用户名为空，身份认证要return user。身份认证return new SimpleAuthenticationInfo(user, password, getName()); 权限认证User currentUser=(User)subject.getPrincipal();  
1. 与前端管理员页面增删改查进行连接，修改调试bug，连接成功
1. 要注意bean 类的方法名的大小写，与属性名要对应。
1. 更新了前端的包，但这边的网页仍然没有任何变化，多次refresh，重启eclipse、电脑仍然没有用。后面清除浏览器缓存，问题得到解决。


